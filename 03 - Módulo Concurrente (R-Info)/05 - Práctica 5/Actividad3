programa Actividad3
procesos
  proceso vaciarBolsa
  comenzar
    mientras(HayFlorEnLaBolsa)
      depositarFlor
  fin
  proceso vaciarEsquina(ES f : numero)
  comenzar
    mientras(HayFlorEnLaEsquina)
      tomarFlor
      f:=f+1
  fin
  proceso tomarXFlores (E x : numero)
  comenzar
    repetir x
      tomarFlor
  fin 
  proceso recolectorADeposito (E avAux: numero; E caAux : numero; ES cantFlores : numero; ES cantEsquinas : numero)
  comenzar
    si ((cantFlores = 10)|(cantEsquinas = 15))
      avAux := PosAv
      BloquearEsquina(10,10)
      Pos(10,10)
      vaciarBolsa
      Pos(avAux,caAux)
      LiberarEsquina(10,10)
      EnviarMensaje(cantFlores,R_Cosechador)
      cantEsquinas := 0
      cantFlores := 0
  fin
areas
  ca3: AreaP (1,3,100,3)
  ca4: AreaP (1,4,100,4)
  deposito: AreaC(10,10,10,10)
  areaCosechador: AreaP(1,5,1,5)
robots
  robot recolector
  variables
    caAux,avAux,cantFlores,cantEsquinas : numero
  comenzar
    derecha
    cantEsquinas := 0
    cantFlores := 0
    caAux := PosCa
    mientras(PosAv<>100)
      vaciarEsquina(cantFlores)
      mover
      cantEsquinas := cantEsquinas + 1
      recolectorADeposito(avAux,caAux,cantFlores,cantEsquinas)
    vaciarEsquina(cantFlores)
    cantEsquinas := cantEsquinas + 1
    recolectorADeposito(avAux,caAux,cantFlores,cantEsquinas)
    EnviarMensaje(0,R_Cosechador)
  fin
  robot cosechador
  variables
    aux,total,cantActivos : numero
  comenzar
    cantActivos := 2
    total := 0
    mientras(cantActivos<>0)
      RecibirMensaje(aux,*)
      si (aux = 0)
        cantActivos := cantActivos - 1
      BloquearEsquina(10,10)
      Pos(10,10)
      tomarXFlores(aux)
      Pos(1,5)
      LiberarEsquina(10,10)
      total := total + aux
    Informar("La cantidad de flores fue ",total)
  fin
variables
  r1,r2 : recolector
  R_Cosechador: cosechador
comenzar
  AsignarArea(R_Cosechador, areaCosechador)
  AsignarArea(r1,ca3)
  AsignarArea(r2,ca4)
  AsignarArea(R_Cosechador, deposito)
  AsignarArea(r1,deposito)
  AsignarArea(r2,deposito)
  Iniciar(r1,1,3)
  Iniciar(r2,1,4)
  Iniciar(R_Cosechador, 1,5)
fin